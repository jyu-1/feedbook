(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{7183:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return t(3552)}])},3552:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return D}});var n=t(5893),o=t(9008),a=t.n(o),i=t(1664),r=t.n(i),c=t(6750),l=t.n(c),d=t(5669),m=t(7294);let _=(0,m.createContext)(null);function u(e){let{children:s}=e,[t,o]=(0,m.useState)({_id:"",name:"",profilePicture:""}),{user:a}=(0,d.Eu)();return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/user/list/").concat(null==a?void 0:a._id),{headers:{Authorization:"Bearer ".concat(null==a?void 0:a.token)}}),s=await e.json();e.ok&&o(s)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};a&&e()},[a]),(0,n.jsx)(_.Provider,{value:{myInfo:t},children:s})}let h=()=>{let e=(0,m.useContext)(_);if(!e)throw Error("useUserContext must be used inside the Auth Provider");return e};var p=t(7106),x=t(1872);function j(){let{logout:e}=(0,d.aU)(),{myInfo:s}=h(),[t,o]=(0,m.useState)(!1),a=()=>{e()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:l().header,children:[(0,n.jsx)("h1",{children:(0,n.jsx)(r(),{href:"/home",children:"feedbook"})}),(0,n.jsx)("input",{placeholder:"Search Feedbook"}),(0,n.jsx)("div",{className:l().portrait_menu,onClick:()=>o(e=>!e),children:(0,n.jsx)("img",{className:l().pfp,src:t?"https://img.icons8.com/pastel-glyph/128/null/cancel--v1.png":s.profilePicture,alt:"pfp"})})]}),(0,n.jsx)("div",{className:"".concat(l().parent_dropdown," ").concat(t?l().dropdown_active:""),children:(0,n.jsxs)("div",{className:l().dropdown,children:[(0,n.jsxs)("div",{className:l().nav_name,children:[(0,n.jsx)("img",{className:l().pfp,src:s.profilePicture,alt:"pfp"}),(0,n.jsx)("div",{children:s.name})]}),(0,n.jsxs)("div",{className:l().nav_item,children:[(0,n.jsx)(x.cKh,{size:30}),"Change Name"]}),(0,n.jsxs)("div",{className:l().nav_item,children:[(0,n.jsx)(x.sHo,{size:30}),"Change Picture"]}),(0,n.jsxs)("div",{className:l().nav_item,onClick:a,children:[(0,n.jsx)(p.VUx,{size:30}),"Logout"]})]})})]})}var f=t(9615),g=t.n(f);function v(e){let{children:s}=e;return(0,n.jsx)("div",{className:g().home,children:(0,n.jsxs)(u,{children:[(0,n.jsx)(j,{}),s]})})}var b=t(4600),k=t.n(b),N=t(9583),w=t(7735);function y(){return(0,n.jsxs)("div",{className:k().nav,children:[(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)(r(),{href:"/",children:[(0,n.jsx)(N.xng,{size:25}),"Home"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.youtube.com/",children:[(0,n.jsx)(N.V2E,{size:25}),"YouTube"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.google.com/",children:[(0,n.jsx)(N.ldW,{size:25}),"Google"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.amazon.com/",children:[(0,n.jsx)(N.UpG,{size:25}),"Amazon"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.facebook.com/",children:[(0,n.jsx)(N.Am9,{size:25}),"Facebook"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.instagram.com/",children:[(0,n.jsx)(N.Zf_,{size:25}),"Instagram"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://nodejs.org/en/docs/",children:[(0,n.jsx)(N.jPo,{size:25}),"Node Docs"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://reactjs.org/",children:[(0,n.jsx)(N.huN,{size:25}),"React Docs"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://expressjs.com/",children:[(0,n.jsx)(w.AmJ,{size:25}),"Express Docs"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://www.mongodb.com/docs/",children:[(0,n.jsx)(w.t$b,{size:25}),"MongoDB Docs"]})}),(0,n.jsx)("div",{className:k().nav_item,children:(0,n.jsxs)("a",{href:"https://github.com/jyu-1",children:[(0,n.jsx)(N.hJX,{size:25}),"\xa9 2023 Nateyu"]})})]})}var P=t(3335),z=t.n(P),C=t(5089);function E(e){let{post:s,setPost:t}=e,{user:o}=(0,d.Eu)(),a=(0,m.useRef)(null),i=(0,m.useRef)(null),[r,c]=(0,m.useState)(!1),[l,_]=(0,m.useState)(!1),[u,p]=(0,m.useState)(!1),{myInfo:j}=h(),f=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/post/like"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({postId:s._id})}),n=await e.json();e.ok||console.log(n.error),e.ok&&t(e=>e.map(e=>e._id===s._id?{...e,userLiked:1,likeCount:e.likeCount+1}:e))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},g=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/post/like/").concat(s._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(null==o?void 0:o.token)}}),n=await e.json();e.ok||console.log(n.error),e.ok&&t(e=>e.map(e=>e._id===s._id?{...e,userLiked:0,likeCount:e.likeCount-1}:e))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},v=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/comment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({postId:s._id,message:i.current?i.current.value:s.message})}),n=await e.json();e.ok||console.log(n.error),e.ok&&(i.current&&(i.current.value=""),t(e=>e.map(e=>e._id===s._id?{...e,comments:[{...n,createdBy:{_id:j._id,name:j.name,profilePicture:j.profilePicture}},...e.comments],commentCount:e.commentCount+1}:e)))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},b=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/post/").concat(s._id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({message:a.current?a.current.value:s.message})}),n=await e.json();e.ok||(console.log(n.error),c(!1)),e.ok&&(c(!1),t(e=>e.map(e=>e._id===s._id?{...e,message:a.current?a.current.value:s.message}:e)))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds."),c(!1)}},k=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/post/").concat(s._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(null==o?void 0:o.token)}}),n=await e.json();e.ok||console.log(n.error),e.ok&&t(e=>e.filter(e=>e._id!==s._id))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};return(0,n.jsxs)("div",{className:z().list_post,children:[(0,n.jsxs)("div",{className:z().info,children:[(0,n.jsx)("img",{className:z().pfp,src:s.createdBy.profilePicture,alt:"pfp"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:z().name,children:s.createdBy.name}),(0,n.jsx)("div",{className:z().date,children:(0,C.Z)(new Date(s.updatedAt),{addSuffix:!0})})]})]}),r?(0,n.jsxs)("div",{className:z().edit_bar,children:[(0,n.jsx)("textarea",{defaultValue:s.message,name:"message",placeholder:"Edit message",minLength:1,maxLength:500,required:!0,ref:a}),(0,n.jsxs)("button",{onClick:b,children:[(0,n.jsx)(x.omL,{size:20}),"Done"]})]}):(0,n.jsx)("div",{className:z().message,children:s.message}),s.uploadImage&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:z().photo,children:"Photo"}),(0,n.jsx)("hr",{})]}),(0,n.jsxs)("div",{className:z().stats,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(x.b8C,{})," ",s.likeCount]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(N.QRJ,{})," ",s.commentCount]})]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:z().like_comment_buttons,children:[0===s.userLiked?(0,n.jsxs)("button",{className:z().unlike_button,onClick:f,children:[(0,n.jsx)(x.K_P,{size:25}),"Like"]}):(0,n.jsxs)("button",{className:z().liked_button,onClick:g,children:[(0,n.jsx)(x.b8C,{size:25}),"Like"]}),u?(0,n.jsxs)("button",{className:z().comment_button,onClick:()=>p(e=>!e),children:[(0,n.jsx)(N.diV,{size:20}),"Comment"]}):(0,n.jsxs)("button",{onClick:()=>p(e=>!e),children:[(0,n.jsx)(N.QRJ,{size:20}),"Comment"]}),j._id===s.createdBy._id&&(0,n.jsxs)(n.Fragment,{children:[r?(0,n.jsxs)("button",{className:z().update_button,onClick:()=>c(!1),children:[(0,n.jsx)(x.omL,{size:25}),"Cancel"]}):(0,n.jsxs)("button",{onClick:()=>c(!0),children:[(0,n.jsx)(x.omL,{size:25}),"Edit"]}),l?(0,n.jsxs)("button",{className:z().delete_confirm,onClick:k,children:[(0,n.jsx)(x.HLd,{size:25}),"Confirm"]}):(0,n.jsxs)("button",{onClick:()=>_(!0),children:[(0,n.jsx)(x.aTj,{size:25}),"Delete"]})]})]}),u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("hr",{className:z().comment_hr}),s.comments&&s.comments.slice(0).reverse().map(e=>(0,n.jsxs)("div",{className:z().comment,children:[(0,n.jsx)("img",{className:z().pfp,src:e.createdBy.profilePicture,alt:"pfp"}),(0,n.jsxs)("div",{className:z().comment_right,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:z().name,children:e.createdBy.name})," ",(0,n.jsx)("span",{className:z().date,children:(0,C.Z)(new Date(e.updatedAt),{addSuffix:!0})})]}),(0,n.jsx)("div",{children:e.message})]})]},e._id)),(0,n.jsxs)("div",{className:z().post_comment,children:[(0,n.jsx)("img",{className:z().pfp,src:j.profilePicture,alt:"pfp"}),(0,n.jsx)("input",{type:"text",name:"message",minLength:1,maxLength:250,required:!0,ref:i,placeholder:"Write a comment..."}),(0,n.jsx)("button",{onClick:v,children:(0,n.jsx)(x.omL,{size:30})})]})]})]})}function S(){let[e,s]=(0,m.useState)([]),[t,o]=(0,m.useState)(!1),{user:a}=(0,d.Eu)(),{myInfo:i}=h(),r=async e=>{if(e.preventDefault(),!a){console.log("You are not logged in");return}o(!0);try{let t=await fetch("".concat("https://feedbook.onrender.com","/api/post"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==a?void 0:a.token)},body:JSON.stringify({message:e.target.message.value})}),n=await t.json();t.ok||(console.log(n.error),o(!1)),t.ok&&(s(e=>[{...n,createdBy:{_id:i._id,name:i.name,profilePicture:i.profilePicture}},...e]),o(!1),e.target.reset())}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds."),o(!1)}};return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/post"),{headers:{Authorization:"Bearer ".concat(null==a?void 0:a.token)}}),t=await e.json();e.ok&&s(t)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};a&&e()},[a]),(0,n.jsxs)("div",{className:z().post_container,children:[(0,n.jsxs)("form",{className:z().create_post,onSubmit:r,children:[(0,n.jsxs)("div",{className:z().post_input,children:[(0,n.jsx)("img",{className:z().pfp,src:i.profilePicture,alt:"pfp"}),(0,n.jsx)("input",{type:"text",name:"message",placeholder:"What's on your mind?",minLength:1,maxLength:500,required:!0,disabled:t})]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:z().post_buttons,children:[(0,n.jsxs)("button",{type:"button",disabled:t,children:[(0,n.jsx)(x.uZU,{size:30}),"Attach a Photo"]}),(0,n.jsxs)("button",{type:"submit",disabled:t,children:[(0,n.jsx)(x.omL,{size:30}),"Post"]})]})]}),e&&e.map(e=>(0,n.jsx)(E,{post:e,setPost:s},e._id))]})}var L=t(6572),A=t.n(L);function B(){let[e,s]=(0,m.useState)([]),{user:t}=(0,d.Eu)();return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("https://feedbook.onrender.com","/api/user/list"),{headers:{Authorization:"Bearer ".concat(null==t?void 0:t.token)}}),n=await e.json();e.ok&&s(n)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};t&&e()},[t]),(0,n.jsx)("div",{className:A().friend_list,children:e&&e.map(e=>(0,n.jsxs)("div",{className:A().friend_item,children:[(0,n.jsx)("img",{src:e.profilePicture,alt:"pfp"}),(0,n.jsx)("div",{children:e.name})]},e._id))})}var T=t(1163);function D(){let[e,s]=(0,m.useState)(!1),{user:t,loadPage:o}=(0,d.Eu)(),i=(0,T.useRouter)();return(0,m.useEffect)(()=>{o&&(t?s(!0):i.push("/"))},[t,i,o]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{children:(0,n.jsx)("title",{children:"Home Page"})}),e&&(0,n.jsx)(v,{children:(0,n.jsxs)("div",{className:g().main_container,children:[(0,n.jsx)(y,{}),(0,n.jsx)(S,{}),(0,n.jsx)(B,{})]})})]})}},6572:function(e){e.exports={friend_list:"friendlist_friend_list__TV8OL",friend_item:"friendlist_friend_item__47XTd"}},6750:function(e){e.exports={header:"header_header__FfSP_",pfp:"header_pfp__IK7Kj",portrait_menu:"header_portrait_menu__rhabr",parent_dropdown:"header_parent_dropdown__YYlvZ",dropdown_active:"header_dropdown_active__x5mpN",dropdown:"header_dropdown__vkcAA",nav_name:"header_nav_name__WkF01",nav_item:"header_nav_item__J8Rkb"}},9615:function(e){e.exports={home:"homeLayout_home__U7tkq",main_container:"homeLayout_main_container__cpqaO"}},3335:function(e){e.exports={post_container:"postcontainer_post_container__GMw8c",create_post:"postcontainer_create_post__ESZwf",post_input:"postcontainer_post_input__JbxIY",pfp:"postcontainer_pfp__2QGKT",post_buttons:"postcontainer_post_buttons__GueZ5",list_post:"postcontainer_list_post__xs2D1",comment_hr:"postcontainer_comment_hr__IxNa1",info:"postcontainer_info__oFRcA",name:"postcontainer_name__PzbFL",photo:"postcontainer_photo__wQe8L",message:"postcontainer_message__6opVK",stats:"postcontainer_stats__zZfy7",like_comment_buttons:"postcontainer_like_comment_buttons___5WUA",unlike_button:"postcontainer_unlike_button__QMVaj",liked_button:"postcontainer_liked_button__Jm94c",delete_confirm:"postcontainer_delete_confirm__5O5LY",comment_button:"postcontainer_comment_button__RS3_O",update_button:"postcontainer_update_button__QPZN8",edit_bar:"postcontainer_edit_bar__mpXBx",post_comment:"postcontainer_post_comment__L3LPq",comment:"postcontainer_comment__2m0AJ",comment_right:"postcontainer_comment_right__qVqPX",date:"postcontainer_date__vDYEw"}},4600:function(e){e.exports={nav:"sidenav_nav__oFl_w",nav_item:"sidenav_nav_item__lIJIq"}}},function(e){e.O(0,[907,415,994,445,348,774,888,179],function(){return e(e.s=7183)}),_N_E=e.O()}]);