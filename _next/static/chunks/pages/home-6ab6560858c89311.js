(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{7183:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return s(3552)}])},3552:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return A}});var n=s(5893),o=s(9008),a=s.n(o),i=s(1664),r=s.n(i),c=s(6750),l=s.n(c),d=s(5669),m=s(7294);let _=(0,m.createContext)(null);function h(e){let{children:t}=e,[s,o]=(0,m.useState)({_id:"",name:"",profilePicture:""}),{user:a}=(0,d.Eu)();return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://localhost:9000","/api/user/list/").concat(null==a?void 0:a._id),{headers:{Authorization:"Bearer ".concat(null==a?void 0:a.token)}}),t=await e.json();e.ok&&o(t)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};a&&e()},[a]),(0,n.jsx)(_.Provider,{value:{myInfo:s},children:t})}let u=()=>{let e=(0,m.useContext)(_);if(!e)throw Error("useUserContext must be used inside the Auth Provider");return e};function p(){let{logout:e}=(0,d.aU)(),{myInfo:t}=u(),[s,o]=(0,m.useState)(!1),a=()=>{e()};return(0,n.jsxs)("div",{className:l().header,children:[(0,n.jsx)("h1",{children:(0,n.jsx)(r(),{href:"/home",children:"feedbook"})}),(0,n.jsx)("input",{placeholder:"Search Feedbook"}),(0,n.jsx)("div",{className:l().portrait_menu,onClick:()=>o(e=>!e),children:(0,n.jsx)("img",{className:l().pfp,src:t.profilePicture,alt:"pfp"})}),s&&(0,n.jsxs)("div",{className:l().dropdown,children:[(0,n.jsxs)("div",{className:l().nav_name,children:[(0,n.jsx)("img",{className:l().pfp,src:t.profilePicture,alt:"pfp"}),(0,n.jsx)("div",{children:t.name})]}),(0,n.jsx)("div",{className:l().nav_item,onClick:a,children:"Change Name"}),(0,n.jsx)("div",{className:l().nav_item,onClick:a,children:"Change Picture"}),(0,n.jsx)("div",{className:l().nav_item,onClick:a,children:"Logout"})]})]})}var f=s(9615),x=s.n(f);function g(e){let{children:t}=e;return(0,n.jsx)("div",{className:x().home,children:(0,n.jsxs)(h,{children:[(0,n.jsx)(p,{}),t]})})}var j=s(4600),v=s.n(j);function k(){return(0,n.jsxs)("div",{className:v().nav,children:[(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)(r(),{href:"/",children:"Home"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.youtube.com/",children:"YouTube"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.google.com/",children:"Google"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.amazon.com/",children:"Amazon"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.facebook.com/",children:"Facebook"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.instagram.com/",children:"Instagram"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://nodejs.org/en/docs/",children:"Node Docs"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://reactjs.org/",children:"React Docs"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://expressjs.com/",children:"Express Docs"})}),(0,n.jsx)("div",{className:v().nav_item,children:(0,n.jsx)("a",{href:"https://www.mongodb.com/docs/",children:"MongoDB Docs"})})]})}var N=s(3335),b=s.n(N),w=s(5089);function y(e){let{post:t,setPost:s}=e,{user:o}=(0,d.Eu)(),a=(0,m.useRef)(null),i=(0,m.useRef)(null),[r,c]=(0,m.useState)(!1),[l,_]=(0,m.useState)(!1),[h,p]=(0,m.useState)(!1),{myInfo:f}=u(),x=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("http://localhost:9000","/api/post/like"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({postId:t._id})}),n=await e.json();e.ok||console.log(n.error),e.ok&&s(e=>e.map(e=>e._id===t._id?{...e,userLiked:1,likeCount:e.likeCount+1}:e))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},g=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("http://localhost:9000","/api/post/like/").concat(t._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(null==o?void 0:o.token)}}),n=await e.json();e.ok||console.log(n.error),e.ok&&s(e=>e.map(e=>e._id===t._id?{...e,userLiked:0,likeCount:e.likeCount-1}:e))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},j=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("http://localhost:9000","/api/comment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({postId:t._id,message:i.current?i.current.value:t.message})}),n=await e.json();e.ok||console.log(n.error),e.ok&&(i.current&&(i.current.value=""),s(e=>e.map(e=>e._id===t._id?{...e,comments:[{...n,createdBy:{_id:f._id,name:f.name,profilePicture:f.profilePicture}},...e.comments],commentCount:e.commentCount+1}:e)))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}},v=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("http://localhost:9000","/api/post/").concat(t._id),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==o?void 0:o.token)},body:JSON.stringify({message:a.current?a.current.value:t.message})}),n=await e.json();e.ok||(console.log(n.error),c(!1)),e.ok&&(c(!1),s(e=>e.map(e=>e._id===t._id?{...e,message:a.current?a.current.value:t.message}:e)))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds."),c(!1)}},k=async()=>{if(!o){console.log("You are not logged in");return}try{let e=await fetch("".concat("http://localhost:9000","/api/post/").concat(t._id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(null==o?void 0:o.token)}}),n=await e.json();e.ok||console.log(n.error),e.ok&&s(e=>e.filter(e=>e._id!==t._id))}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};return(0,n.jsxs)("div",{className:b().list_post,children:[(0,n.jsxs)("div",{className:b().info,children:[(0,n.jsx)("img",{className:b().pfp,src:t.createdBy.profilePicture,alt:"pfp"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:b().name,children:t.createdBy.name}),(0,n.jsx)("div",{className:b().date,children:(0,w.Z)(new Date(t.updatedAt),{addSuffix:!0})})]})]}),r?(0,n.jsxs)("div",{className:b().edit_bar,children:[(0,n.jsx)("textarea",{defaultValue:t.message,name:"message",placeholder:"Edit message",minLength:1,maxLength:500,required:!0,ref:a}),(0,n.jsx)("button",{onClick:v,children:"Update"})]}):(0,n.jsx)("div",{className:b().message,children:t.message}),t.uploadImage&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:b().photo,children:"Photo"}),(0,n.jsx)("hr",{})]}),(0,n.jsxs)("div",{className:b().stats,children:[(0,n.jsxs)("div",{children:["Likes: ",t.likeCount]}),(0,n.jsxs)("div",{children:[t.commentCount," comments"]})]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:b().like_comment_buttons,children:[0===t.userLiked?(0,n.jsx)("button",{onClick:x,children:"Like"}):(0,n.jsx)("button",{className:b().liked_button,onClick:g,children:"Unlike"}),h?(0,n.jsx)("button",{className:b().comment_button,onClick:()=>p(e=>!e),children:"Hide Comment"}):(0,n.jsx)("button",{onClick:()=>p(e=>!e),children:"Comment"}),f._id===t.createdBy._id&&(0,n.jsxs)(n.Fragment,{children:[r?(0,n.jsx)("button",{className:b().update_button,onClick:()=>c(!1),children:"Cancel Update"}):(0,n.jsx)("button",{onClick:()=>c(!0),children:"Update Post"}),l?(0,n.jsx)("button",{className:b().delete_confirm,onClick:k,children:"Confirm Delete"}):(0,n.jsx)("button",{onClick:()=>_(!0),children:"Delete Post"})]})]}),h&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("hr",{className:b().comment_hr}),t.comments&&t.comments.slice(0).reverse().map(e=>(0,n.jsxs)("div",{className:b().comment,children:[(0,n.jsx)("img",{className:b().pfp,src:e.createdBy.profilePicture,alt:"pfp"}),(0,n.jsxs)("div",{className:b().comment_right,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:b().name,children:e.createdBy.name})," ",(0,n.jsx)("span",{className:b().date,children:(0,w.Z)(new Date(e.updatedAt),{addSuffix:!0})})]}),(0,n.jsx)("div",{children:e.message})]})]},e._id)),(0,n.jsxs)("div",{className:b().post_comment,children:[(0,n.jsx)("img",{className:b().pfp,src:f.profilePicture,alt:"pfp"}),(0,n.jsx)("input",{type:"text",name:"message",minLength:1,maxLength:250,required:!0,ref:i,placeholder:"Write a comment..."}),(0,n.jsx)("button",{onClick:j,children:"Post"})]})]})]})}function P(){let[e,t]=(0,m.useState)([]),[s,o]=(0,m.useState)(!1),{user:a}=(0,d.Eu)(),{myInfo:i}=u(),r=async e=>{if(e.preventDefault(),!a){console.log("You are not logged in");return}o(!0);try{let s=await fetch("".concat("http://localhost:9000","/api/post"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null==a?void 0:a.token)},body:JSON.stringify({message:e.target.message.value})}),n=await s.json();s.ok||(console.log(n.error),o(!1)),s.ok&&(t(e=>[{...n,createdBy:{_id:i._id,name:i.name,profilePicture:i.profilePicture}},...e]),o(!1),e.target.reset())}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds."),o(!1)}};return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://localhost:9000","/api/post"),{headers:{Authorization:"Bearer ".concat(null==a?void 0:a.token)}}),s=await e.json();e.ok&&t(s)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};a&&e()},[a]),(0,n.jsxs)("div",{className:b().post_container,children:[(0,n.jsxs)("form",{className:b().create_post,onSubmit:r,children:[(0,n.jsxs)("div",{className:b().post_input,children:[(0,n.jsx)("img",{className:b().pfp,src:i.profilePicture,alt:"pfp"}),(0,n.jsx)("input",{type:"text",name:"message",placeholder:"What's on your mind?",minLength:1,maxLength:500,required:!0,disabled:s})]}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:b().post_buttons,children:[(0,n.jsx)("button",{type:"button",disabled:s,children:"Attach a Photo"}),(0,n.jsx)("button",{type:"submit",disabled:s,children:"Post"})]})]}),e&&e.map(e=>(0,n.jsx)(y,{post:e,setPost:t},e._id))]})}var C=s(6572),E=s.n(C);function S(){let[e,t]=(0,m.useState)([]),{user:s}=(0,d.Eu)();return(0,m.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat("http://localhost:9000","/api/user/list"),{headers:{Authorization:"Bearer ".concat(null==s?void 0:s.token)}}),n=await e.json();e.ok&&t(n)}catch(e){e instanceof Error&&console.log(e.message),console.log("Server is starting. Please wait about 20 seconds.")}};s&&e()},[s]),(0,n.jsx)("div",{className:E().friend_list,children:e&&e.map(e=>(0,n.jsxs)("div",{className:E().friend_item,children:[(0,n.jsx)("img",{src:e.profilePicture,alt:"pfp"}),(0,n.jsx)("div",{children:e.name})]},e._id))})}var L=s(1163);function A(){let[e,t]=(0,m.useState)(!1),{user:s,loadPage:o}=(0,d.Eu)(),i=(0,L.useRouter)();return(0,m.useEffect)(()=>{o&&(s?t(!0):i.push("/"))},[s,i,o]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{children:(0,n.jsx)("title",{children:"Home Page"})}),e&&(0,n.jsx)(g,{children:(0,n.jsxs)("div",{className:x().main_container,children:[(0,n.jsx)(k,{}),(0,n.jsx)(P,{}),(0,n.jsx)(S,{})]})})]})}},6572:function(e){e.exports={friend_list:"friendlist_friend_list__TV8OL",friend_item:"friendlist_friend_item__47XTd"}},6750:function(e){e.exports={header:"header_header__FfSP_",pfp:"header_pfp__IK7Kj",portrait_menu:"header_portrait_menu__rhabr",dropdown:"header_dropdown__vkcAA",nav_name:"header_nav_name__WkF01",nav_item:"header_nav_item__J8Rkb"}},9615:function(e){e.exports={home:"homeLayout_home__U7tkq",main_container:"homeLayout_main_container__cpqaO"}},3335:function(e){e.exports={post_container:"postcontainer_post_container__GMw8c",create_post:"postcontainer_create_post__ESZwf",post_input:"postcontainer_post_input__JbxIY",pfp:"postcontainer_pfp__2QGKT",post_buttons:"postcontainer_post_buttons__GueZ5",list_post:"postcontainer_list_post__xs2D1",comment_hr:"postcontainer_comment_hr__IxNa1",info:"postcontainer_info__oFRcA",name:"postcontainer_name__PzbFL",photo:"postcontainer_photo__wQe8L",message:"postcontainer_message__6opVK",stats:"postcontainer_stats__zZfy7",like_comment_buttons:"postcontainer_like_comment_buttons___5WUA",liked_button:"postcontainer_liked_button__Jm94c",delete_confirm:"postcontainer_delete_confirm__5O5LY",comment_button:"postcontainer_comment_button__RS3_O",update_button:"postcontainer_update_button__QPZN8",edit_bar:"postcontainer_edit_bar__mpXBx",post_comment:"postcontainer_post_comment__L3LPq",comment:"postcontainer_comment__2m0AJ",comment_right:"postcontainer_comment_right__qVqPX",date:"postcontainer_date__vDYEw"}},4600:function(e){e.exports={nav:"sidenav_nav__oFl_w",nav_item:"sidenav_nav_item__lIJIq"}}},function(e){e.O(0,[579,774,888,179],function(){return e(e.s=7183)}),_N_E=e.O()}]);